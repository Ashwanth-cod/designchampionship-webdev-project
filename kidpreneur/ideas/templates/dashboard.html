  {% extends "base.html" %}
  {% load static %}
  {% block title %}Dashboard{% endblock %}

  {% block extra_head %}
  <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
  {% endblock %}

  {% block content %}
  <div class="dashboard-container theme-red">

    <!-- Left Side -->
    <div>
      <!-- Tabs -->
      <ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="ideas-tab" data-bs-toggle="tab" data-bs-target="#ideas" type="button">
            ğŸ’¡ My Ideas
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="create-tab" data-bs-toggle="tab" data-bs-target="#create" type="button">
            â• Create Idea
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="custom-tab" data-bs-toggle="tab" data-bs-target="#custom" type="button">
            ğŸ¨ Customization
          </button>
        </li>
      </ul>

      <!-- Tab Content -->
      <div class="tab-content p-3 card-custom" id="dashboardTabsContent">
        
        <!-- My Ideas -->
        <div class="tab-pane fade show active" id="ideas">
          <h3>ğŸ’¡ My Ideas</h3>
          {% for idea in ideas %}
            <div class="card-custom idea-card mb-3">
              <h4>{{ idea.title }}</h4>
              <p>{{ idea.description|truncatewords:20 }}</p>
              <p><small>Created on {{ idea.created_at|date:"M d, Y" }}</small></p>

              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <span class="me-3">ğŸ‘ {{ idea.likes.count }}</span>
                  <span>ğŸ’¬ {{ idea.comments.count }}</span>
                </div>
                <div>
                  <a href="{% url 'idea-detail' idea.slug %}" class="btn btn-fun-red btn-sm">View</a>
                  <a href="{% url 'idea_update' idea.slug %}" class="btn btn-fun-blue btn-sm">Edit</a>
                  <form method="POST" action="{% url 'idea_delete' idea.slug %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-fun-yellow btn-sm">Delete</button>
                  </form>
                </div>
              </div>
            </div>
          {% empty %}
            <p>You havenâ€™t added any ideas yet.</p>
          {% endfor %}
        </div>

        <!-- Create Idea -->
        <div class="tab-pane fade" id="create">
          <h3>â• Create New Idea</h3>
          <br>
          
          <a href="{% url 'idea_create' %}" class="btn-fun-red w-100">ğŸš€ Go to Create Idea Page</a>
        </div>

        <!-- Customization -->
        <div class="tab-pane fade" id="custom">
          <h3>ğŸ¨ Customize Dashboard Theme</h3>
          <br>
          <form id="themeForm">
            <div class="mb-3">
              <label for="themeSelect" class="form-label"><b>Select Theme:</b></label>
              <select id="themeSelect" class="form-select">
                <option value="theme-red">Red</option>
                <option value="theme-yellow">Yellow</option>
                <option value="theme-blue">Blue</option>
                <option value="theme-green">Green</option>
                <option value="theme-pink">Pink</option>
                <option value="theme-purple">Purple</option>
                <option value="theme-orange">Orange</option>
              </select>
            </div>
          </form>
        </div>

      </div>
    </div>

    <!-- Right Side (Profile) -->
    <div>
      <div class="card-custom profile">
        <h3>ğŸ‘¤ My Profile</h3>
        <div class="info-item"><b>Username:</b> {{ request.user.username }}</div>
        <div class="info-item"><b>Email:</b> {{ request.user.email }}</div>
        <div class="info-item"><b>First Name:</b> {{ request.user.first_name }}</div>
        <div class="info-item"><b>Last Name:</b> {{ request.user.last_name }}</div>
        <div class="info-item"><b>Phone:</b> {{ request.user.phone_number }}</div>
        <div class="info-item"><b>Date of Birth:</b> {{ request.user.dob }}</div>
        <div class="info-item"><b>Age:</b> {{ request.user.age }}</div>
        <div class="info-item"><b>Student:</b> {% if request.user.is_student %}Yes{% else %}No{% endif %}</div>
        {% if request.user.is_student %}
          <div class="info-item"><b>School:</b> {{ request.user.school_name }}</div>
        {% endif %}
        <div class="mt-3">
          <a href="{% url 'user_update' %}" class="btn-fun-blue w-100">âœï¸ Update Profile</a>
        </div>
      </div>
    </div>

  </div>

  <script>
  const themeSelect = document.getElementById("themeSelect");
  const dashboard = document.querySelector(".dashboard-container");

  // Load saved theme from localStorage
  const savedTheme = localStorage.getItem("dashboardTheme");
  if (savedTheme) {
      dashboard.className = "dashboard-container " + savedTheme;
      themeSelect.value = savedTheme;
  }

  // Update theme on selection
  themeSelect.addEventListener("change", () => {
      const theme = themeSelect.value;
      dashboard.className = "dashboard-container " + theme;
      localStorage.setItem("dashboardTheme", theme); // save theme
  });
  </script>
  {% endblock %}
