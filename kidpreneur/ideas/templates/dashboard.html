{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
{% load static %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
  .dashboard-container {
    display: grid;
    grid-template-columns: 3fr 2fr; /* Left (Ideas + Create), Right (Profile wider) */
    gap: 20px;
    margin-top: 20px;
  }

  .card-custom {
    background: #fff;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    transition: 0.2s ease-in-out;
    margin-bottom: 20px;
  }

  .card-custom:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.12);
  }

  /* Yellow & Blue Theme */
  .nav-tabs .nav-link {
    font-weight: 600;
    border-radius: 10px 10px 0 0;
    background: #003566; /* Dark Blue */
    color: #003566;      /* Dark Blue */
    margin-right: 5px;
  }

  .nav-tabs .nav-link.active {
    color: #000000ff;      /* Yellow */
    background: #000000ff;
  }

  .btn-fun {
    background: linear-gradient(135deg, #003566, #00509e);
    border: none;
    color: #ffe066;
    font-weight: bold;
    padding: 10px 16px;
    border-radius: 12px;
    transition: 0.3s;
  }

  .btn-fun:hover {
    background: linear-gradient(135deg, #00509e, #003566);
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  }

  .info-item {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
    font-size: 0.95rem;
  }

  .info-item i {
    width: 22px;
    color: #003566;
    margin-right: 10px;
  }
</style>

<div class="dashboard-container">
  <!-- Left Side (Tabs for Ideas + Create) -->
  <div>
    <!-- Tabs -->
    <ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="ideas-tab" data-bs-toggle="tab" data-bs-target="#ideas" type="button" role="tab">
          💡 My Ideas
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="create-tab" data-bs-toggle="tab" data-bs-target="#create" type="button" role="tab">
          ➕ Create Idea
        </button>
      </li>
    </ul>

    <!-- Tab Content -->
    <div class="tab-content p-3 card-custom" id="dashboardTabsContent">
      <!-- My Ideas -->
      <div class="tab-pane fade show active" id="ideas" role="tabpanel">
        <h3>💡 My Ideas</h3>
        {% for idea in ideas %}
          <div class="card-custom idea-card mb-3">
            <h4>{{ idea.title }}</h4>
            <p>{{ idea.description|truncatewords:20 }}</p>
            <p><small>Created on {{ idea.created_at|date:"M d, Y" }}</small></p>

            <div class="d-flex justify-content-between align-items-center">
              <!-- Likes & Comments -->
              <div>
                <span class="me-3">👍 {{ idea.likes.count }}</span>
                <span>💬 {{ idea.comments.count }}</span>
              </div>
              <!-- Actions -->
              <div>
                <a href="{% url 'idea_detail' idea.slug %}" class="btn btn-outline-success btn-sm">View</a>
                <a href="{% url 'idea_update' idea.slug %}" class="btn btn-outline-primary btn-sm">Edit</a>
                <form method="POST" action="{% url 'idea_delete' idea.slug %}" style="display:inline;">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-outline-danger btn-sm">Delete</button>
                </form>
              </div>
            </div>
          </div>
        {% empty %}
          <p>You haven’t added any ideas yet.</p>
        {% endfor %}
      </div>

      <!-- Create Idea -->
      <div class="tab-pane fade" id="create" role="tabpanel">
        <h3>➕ Create New Idea</h3>
        <br>
        <a href="{% url 'idea_create' %}" class="btn-fun w-100" style="text-decoration:none; margin-left: 20px">🚀 Go to Create Idea Page</a>
      </div>
    </div>
  </div>

  <!-- Right Side (Profile - wider card) -->
  <div>
    <div class="card-custom profile">
      <h3>👤 My Profile</h3>
      <div class="info-item"><i class="fas fa-user"></i> <b>Username:</b> {{ request.user.username }}</div>
      <div class="info-item"><i class="fas fa-envelope"></i> <b>Email:</b> {{ request.user.email }}</div>
      <div class="info-item"><i class="fas fa-id-badge"></i> <b>First Name:</b> {{ request.user.first_name }}</div>
      <div class="info-item"><i class="fas fa-id-badge"></i> <b>Last Name:</b> {{ request.user.last_name }}</div>
      {% if request.user.phone %}
        <div class="info-item"><i class="fas fa-phone"></i> <b>Phone:</b> {{ request.user.phone }}</div>
      {% endif %}
      {% if request.user.is_student %}
        <div class="info-item"><i class="fas fa-school"></i> <b>School:</b> {{ request.user.school_name }}</div>
      {% endif %}
      {% if request.user.dob %}
        <div class="info-item"><i class="fas fa-birthday-cake"></i> <b>DOB:</b> {{ request.user.dob }}</div>
        <div class="info-item"><i class="fas fa-hourglass-half"></i> <b>Age:</b> {{ request.user.age }}</div>
      {% endif %}

      <div class="mt-3">
        <a href="{% url 'user_update' %}" class="btn-fun w-100">✏️ Update Profile</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}
